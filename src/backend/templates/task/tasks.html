{% extends "base.html" %}

{% block title %}Task List{% endblock %}

{% block content %}

<h1 class="text-2xl mb-4 flex items-center">
    Tasks
    <a href="/task/create" class="ml-4 text-[#0e5c6a] hover:underline">
        <svg class="w-6 h-6 inline-block" fill="currentColor" viewBox="0 0 20 20">
            <path fill-rule="evenodd" d="M10 5a1 1 0 011 1v3h3a1 1 0 110 2h-3v3a1 1 0 11-2 0v-3H6a1 1 0 110-2h3V6a1 1 0 011-1z" clip-rule="evenodd"/>
        </svg>
    </a>
</h1>

<table class="min-w-full bg-white rounded-lg overflow-hidden shadow-md">
    <thead>
        <tr class="bg-[#002F41] text-white">
            {% for header in headers %}
                <th class="w-1/{{ headers|length }} text-center py-3 px-4 uppercase font-semibold text-sm">{{ header }}</th>
            {% endfor %}
        </tr>
    </thead>
    <tbody class="text-gray-700">
        {% for row in data %}
            <tr class="{% if loop.index is even %}bg-gray-50{% endif %} hover:bg-gray-100">
                {% for field in headers %}
                    {% set key = field.lower().replace(" ", "_") %}
                    <td class="w-1/{{ headers|length }} text-center py-3 px-4">
                        {% if field == 'Title' %}
                            <a href="/task/{{ row['id'] }}" class="text-[#0e5c6a] hover:underline">{{ row[key] }}</a>
                        {% elif field == 'Project' %}
                            <a href="/project/{{ row['project_id'] }}" class="text-[#0e5c6a] hover:underline">{{ row['project_name'] }}</a>
                        {% elif field == 'User' %}
                            <a href="/user/{{ row['user_id'] }}" class="text-[#0e5c6a] hover:underline">{{ row['user_id'] }}</a>
                        {% elif field == 'Status' %}
                            {% if row[key] == 'Completed' %}
                                <span class="bg-green-200 text-green-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded">{{ row[key] }}</span>
                            {% elif row[key] == 'In Progress' %}
                                <span class="bg-yellow-200 text-yellow-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded">{{ row[key] }}</span>
                            {% elif row[key] == 'Pending' %}
                                <span class="bg-red-200 text-red-800 text-xs font-semibold mr-2 px-2.5 py-0.5 rounded">{{ row[key] }}</span>
                            {% else %}
                                {{ row[key] }}
                            {% endif %}
                        {% else %}
                            {{ row[key] }}
                        {% endif %}
                    </td>
                {% endfor %}
            </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock %}